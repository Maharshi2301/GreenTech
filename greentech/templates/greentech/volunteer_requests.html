{% extends "greentech/base.html" %}
{% block title %}Volunteer Requests | GreenTech{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2 class="mb-4">Community Requests</h2>

<!--  &lt;!&ndash; Display messages &ndash;&gt;-->
<!--  {% if messages %}-->
<!--    {% for msg in messages %}-->
<!--      <div class="alert alert-{{ msg.tags }} alert-dismissible fade show" role="alert">-->
<!--        {{ msg }}-->
<!--        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>-->
<!--      </div>-->
<!--    {% endfor %}-->
<!--  {% endif %}-->

  <!-- Volunteer Requests Table -->
  <table class="table table-hover table-bordered align-middle">
    <thead class="table-dark">
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Phone #</th>
        <th>Interest</th>
        <th>Availability</th>
        <th>Status</th>
        <th>Created</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      {% for req in requests %}
        <tr class="{% if req.status == 'P' %}table-warning{% endif %}">
          <td>{{ req.name }}</td>
          <td>{{ req.email }}</td>
          <td>{{ req.phone_number }}</td>
          <td>{{ req.area_of_interest }}</td>
          <td>{{ req.availability }}</td>
          <td>
            <span class="badge {% if req.status == 'A' %}bg-success{% elif req.status == 'D' %}bg-danger{% else %}bg-secondary{% endif %}">
              {{ req.get_status_display }}
            </span>
          </td>
          <td>{{ req.created_at|date:"M d, Y H:i" }}</td>
          <td>
            {% if req.status == 'P' %}
              <form action="{% url 'accept_volunteer' req.pk %}" method="post" style="display:inline;">
                  {% csrf_token %}
                  <button type="submit" class="btn btn-sm btn-success">Accept</button>
              </form>
              <form action="{% url 'deny_volunteer' req.pk %}" method="post" style="display:inline;">
                  {% csrf_token %}
                  <button type="submit" class="btn btn-sm btn-danger ms-1">Deny</button>
              </form>
            {% else %}
              <span class="text-muted">â€”</span>
            {% endif %}
          </td>
        </tr>
      {% empty %}
        <tr>
          <td colspan="8" class="text-center text-muted">No volunteer requests yet.</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
